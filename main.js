(()=>{"use strict";function t(t){function e(t){return Math.floor(Math.random()*(t-1+1)+1)}return[e(t),e(t)]}const e=function(t,e,n){const o=[],r="h"===n?1:0,s=[];let a=t[r]||1,c=0,i=0;for(;a+e>10;)a-=1;0===r?(o.push(a),o.push(t[1]||1)):(o.push(t[0]||1),o.push(a));for(let t=0;t<e;t+=1)s.push({coords:[o[0]+c,o[1]+i],damaged:!1}),"h"===n?i+=1:c+=1;return s},n=function(t=[1,1],n=1,o="h",r=!1){return{length:n,damage:e(t,n,o),position:o,sunk:r,coords:t,hit:function(t){this.damage[t].damaged=!0},isSunk:function(){for(let t=1;t<this.damage.length;t+=1)if(!1===this.damage[t].damaged)return;this.sunk=!0},rotate:function(){let t="h";"h"===this.position&&(t="v"),this.damage=e(this.damage[0].coords,this.length,t),this.position=t}}},o=function(){return{board:{placed:[],misses:[]},placeship:function(t,e){const o=n(t,e);this.board.placed.push(o)},randomize:function(e,o=5){let r=o;function s(){const e=n(t(10),r),o=function(t){const e=[];for(let n=0;n<t.damage.length;n+=1)e.push(t.damage[n].coords);return e}(e);return o[0]>10&&s(),o[1]>10&&s(),function(t,e){const n=[];t.forEach((t=>{n.push(t)})),e.forEach((t=>{n.push(t)}));const o=[...new Set(n)];return o.length===n.length&&o}(c,o)||s(),{ship:e,coords:o}}const a=[],c=[];for(;a.length<e;){const t=s();t&&(a.push(t.ship),t.coords.forEach((t=>{c.push(t)})),r-=1)}const i=this.board.placed;a.forEach((t=>{i.push(t)}))},receiveAttack:function(t){const e=this.board.placed,n=function(){let n=!1;return e.forEach((o=>o.damage.forEach((r=>{r.coords.toString()===t.toString()&&(n=[e.indexOf(o),o.damage.indexOf(r)])})))),n}();if(this.board.misses.push(t),n)return e[n[0]].hit(n[1]),e[n[0]].isSunk(),e[n[0]].coords},areAllShipsSunk:function(){const t=this.board.placed;for(let e=0;e<t.length;e+=1)if(!0!==t[e].sunk)return!1;return!0}}},r=function(){return{attack:function(t,e){if(!t)return!1;const n=t.board.misses[0]?t.board.misses:[[]];for(let t=0;t<n.length;t+=1)if(n[t].toString()===e.toString())return!1;return t.receiveAttack(e)},randomAttack:function(e){const n=t(10),o=this.attack(e,n);return!1===o&&this.randomAttack(e),o}}},s=function(t){const e=document.createElement("table");e.classList.add("game-table"),e.classList.add("full-screen");const n=t<27?t:26,o=document.createElement("tr");for(let t=0;t<=n;t+=1){const e=document.createElement("th");0!==t&&(e.innerText=t),o.appendChild(e)}e.appendChild(o);for(let t=0;t<n;t+=1){const o=document.createElement("tr"),r=document.createElement("th");r.innerText=String.fromCharCode(t+65),o.appendChild(r);for(let e=0;e<n;e+=1){const n=document.createElement("td");n.setAttribute("data",`${t+1},${e+1}`),n.classList.add("grid"),o.appendChild(n)}e.appendChild(o)}return e},a=function(t,e){return t.querySelector(`[data="${e}"]`)||!1},c=document.querySelector("#top-center"),i=document.querySelector("#bottom-center");c.appendChild(s(10)),i.appendChild(s(10));const d=r(),u=o();u.randomize(5);const h=r(),l=o();l.randomize(5),function(t,e){for(let n=0;n<t.length;n+=1)t[n].damage.forEach((t=>{var n,o;n=e,o=t.coords.toString(),a(n,o).classList.add("ship")}))}(u.board.placed,i),document.addEventListener("click",(t=>{function e(t,e,n){const o=e.misses[e.misses.length-1].toString(),r=a(t,o),s=function(){const t=document.createElement("div");return t.classList.add("peg"),t}();r.appendChild(s),n&&s.classList.add("damaged")}const n=t.target.closest("table"),o=t.target.closest("td");if(o&&""==o.innerHTML&&c.querySelector("table")===n){const t=d.attack(l,o.getAttribute("data"));e(c,l.board,t);const n=h.randomAttack(u);e(i,u.board,n)}}))})();